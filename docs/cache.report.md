# Redis 기반 캐싱 및 로직 이관을 통한 성능 최적화 방안

본 보고서는 콘서트 예매 시스템의 주요 기능에서 Redis를 활용한 캐싱 및 로직 이관을 통해 성능을 최적화할 방안을 제시합니다. 각 기능의 특성에 맞는 Redis 도입 필요성과 기대 효과를 설명하여 DB 부하 감소와 사용자 응답 속도 향상에 기여하고자 합니다.

## 1. 대기열 기능의 Redis 로직 이관 필요성 및 기대 효과

### 1.1 기능 개요

```
대기열 기능은 동시 사용자 트래픽을 효과적으로 제어하여 예매 서버의 안정성을 확보하는 역할을 합니다. 주요 기능에는 대기열 토큰 발급, 토큰 상태 조회, 토큰 활성화 및 만료 처리가 포함됩니다.
```

### 1.2 성능 문제 및 도입 필요성

- 실시간 업데이트 요구: 대기열 상태는 실시간으로 변경되므로, 데이터베이스를 통한 관리 시 과도한 트랜잭션 발생으로 인해 성능 저하가 발생할 수 있습니다.
- TTL 기반 만료 관리의 필요: 대기열 토큰의 유효 기간을 TTL로 설정하여 자동으로 만료되게 하면, 수동 만료 처리 작업을 줄이고 실시간 상태 관리를 단순화할 수 있습니다.
- DB 부하 감소 필요: 대기열 관리 로직이 DB에 의존할 경우 트랜잭션 비용이 크게 증가할 수 있으므로, Redis를 통해 데이터베이스 부하를 경감하는 것이 필요합니다.

### 1.3 Redis 도입을 통한 성능 최적화 방안

- 빠른 읽기/쓰기 성능 활용: Redis의 빠른 I/O 성능을 통해 실시간 대기열 상태 관리, 토큰 발급, 활성화, 만료 처리를 신속하게 처리합니다.
- TTL 활용: Redis의 TTL(Time-To-Live)을 통해 대기열 토큰의 유효 기간을 설정하여 만료 시점에 자동으로 삭제하고 실시간 상태 초기화 및 유효성 관리를 단순화할 수 있습니다.
- Sorted Set 활용: Redis의 Sorted Set을 사용해 대기 순서를 관리하여 순차적 대기열 처리와 상태 조회 성능을 극대화합니다.

### 1.4 기대 효과

- 실시간 처리 성능 개선: Redis의 고성능 I/O와 TTL 설정을 통해 대기열의 실시간 상태 갱신을 더욱 신속하게 처리할 수 있습니다.
- 효율적인 상태 변경: 파이프라인을 통해 일괄 처리하여 실시간 상태 전환의 성능을 최적화할 수 있습니다.
- DB 부하 감소 및 트랜잭션 비용 절감: Redis 파이프라인을 통해 별도의 트랜잭션 없이 상태 전환을 원자적으로 처리하여 성능과 데이터 일관성을 보장합니다.

## 2. 좌석 예약 기능의 Redis 로직 이관 필요성 및 기대 효과

### 2.1 기능 개요

```
좌석 예약 기능은 사용자가 좌석을 예약할 때 일정 시간 동안 임시로 좌석을 배정하고, 결제가 완료되면 예약을 확정합니다. 주요 기능은 좌석 임시 배정, 좌석 예약 상태 갱신 및 만료 처리입니다.
```

### 2.2 성능 문제 및 도입 필요성

- TTL을 통한 임시 배정 좌석 자동 만료: 결제가 이루어지지 않을 경우, 좌석이 자동으로 초기 상태로 복귀할 수 있도록 TTL을 활용하여 만료 관리 작업을 단순화할 필요가 있습니다.
- DB 부하 경감: 좌석 예약 상태를 DB에 직접 저장할 경우 잦은 상태 변경으로 인해 DB 부하가 가중될 수 있습니다.

### 2.3 Redis 로직 이관을 통한 성능 최적화 방안

- 좌석 임시 배정 및 TTL 설정: 좌석 예약 시 Redis에 임시 상태로 저장하고, TTL을 5분으로 설정하여 결제가 완료되지 않으면 자동으로 만료되도록 합니다.
- 상태 변경 시 캐싱: 결제가 완료되면 Redis에서 상태를 갱신하여 최종 예약 상태를 반영하고, 최종 상태만 데이터베이스에 저장하여 장기적인 데이터 일관성을 유지합니다.
- 빠른 상태 조회: 실시간으로 좌석 상태를 관리하며, 사용자가 동시에 좌석 정보를 조회하거나 예약할 때 Redis를 통해 빠르게 상태를 반환하여 혼선을 방지합니다.

### 2.4 기대 효과

- 임시 배정 자동 만료로 상태 관리 최적화: TTL 설정을 통해 임시 배정 좌석의 상태를 자동으로 초기화하여, 불필요한 만료 처리 작업을 줄이고 상태 관리를 간소화할 수 있습니다.
- DB 부하 감소: 좌석 예약의 중간 상태를 Redis에서 관리하여 최종 상태만 DB에 저장함으로써 데이터베이스 부하를 줄일 수 있습니다.

## 3. 콘서트 정보 조회 기능의 Redis 로직 이관 필요성 및 기대 효과

### 3.1 기능 개요

```콘서트 정보 조회 기능은 특정 콘서트의 기본 정보(이름, 날짜, 장소, 가격 등)를 사용자에게 제공합니다. 이 정보는 메인 화면이나 콘서트 세부 페이지에서 자주 사용됩니다.

```

### 3.2 Redis 도입 필요성

- 변경 빈도가 낮은 고빈도 조회 데이터: 콘서트 정보는 변경이 적고 조회 빈도가 높아, 캐싱을 통해 성능을 크게 개선할 수 있습니다.
- 장기 TTL 설정 가능: 데이터 변경이 빈번하지 않으므로 TTL을 길게 설정하여 캐시를 장기간 유지할 수 있으며, 캐시 일관성을 확보할 수 있습니다.
- DB 부하 감소: 고빈도 조회가 발생하는 콘서트 정보를 캐싱하여 데이터베이스에 가해지는 부하를 줄일 필요가 있습니다.

### 3.3 성능 최적화 방안

- 콘서트 정보 개별 캐싱 및 장기 TTL 설정: 각 콘서트 정보를 Redis에 캐싱하고, 데이터 변경이 발생할 때만 수동으로 갱신하는 방식으로 일관성을 유지합니다.
- DB 접근 최소화: 자주 변경되지 않는 콘서트 정보를 캐싱함으로써 데이터베이스 조회 빈도를 줄입니다.

### 3.4 기대 효과

- 데이터베이스 부하 감소: 자주 조회되는 콘서트 기본 정보를 캐싱하여 불필요한 DB 조회를 줄입니다.
- 빠른 응답 제공: 캐시된 콘서트 정보를 사용하여 사용자에게 빠르게 응답할 수 있습니다.
- 데이터 일관성 유지: TTL을 길게 설정하여 자주 변경되지 않는 데이터에 대한 일관성을 보장하고, 수동 갱신을 통해 최신 상태를 유지할 수 있습니다.

## 4. 좌석 조회 기능의 Redis 캐싱 도입 필요성 및 기대 효과

### 4.1 기능 개요

```
좌석 정보 조회는 특정 콘서트의 예약 가능 좌석을 실시간으로 확인하여 사용자에게 제공합니다.
```

### 4.2 Redis 도입 필요성

- 실시간 데이터 반영 필요: 좌석 상태는 실시간으로 변경될 수 있으며, 이에 따라 최신 좌석 상태를 빠르게 제공해야 합니다.
- DB 트랜잭션 절감: 실시간 상태 변경으로 인한 데이터베이스 트랜잭션 부하를 캐싱을 통해 경감할 필요가 있습니다.

### 4.3 성능 최적화 방안

- 좌석 정보 개별 캐싱 및 짧은 TTL 관리: 좌석 정보를 Redis에 캐싱하고 짧은 TTL을 설정하여 주기적으로 최신 상태를 반영합니다. 예약 또는 상태 변경 시 해당 좌석 정보만 갱신하여 일관성을 유지합니다.
- 상태 변경 시 캐시 갱신: 예약이 이루어질 때마다 해당 좌석 정보를 갱신하여 일관성을 확보할 수 있습니다.

### 4.4 기대 효과

- 빠른 상태 조회: 최신 좌석 상태를 Redis에서 즉시 제공하여 실시간 성능을 보장할 수 있습니다.
- DB 트랜잭션 감소: 좌석 상태를 캐싱하여 데이터베이스 조회 빈도를 줄이고 DB 성능을 최적화할 수 있습니다.
- 일관성 유지: 짧은 TTL 설정과 상태 변경 시 캐시 무효화를 통해 실시간 데이터를 일관성 있게 유지할 수 있습니다.
